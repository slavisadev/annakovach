/*! Thrive Comments - 2022-01-25
* http://www.thrivethemes.com/
* Copyright (c) 2022 Thrive Themes */

"use strict";function TCMStorage(){this.api=window.localStorage||FallbackStorage,this.listening=!1,this.listeners={}}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},ThriveComments=ThriveComments||{};ThriveComments.util=ThriveComments.util||{},_.templateSettings={evaluate:/<#([\s\S]+?)#>/g,interpolate:/<#=([\s\S]+?)#>/g,escape:/<#-([\s\S]+?)#>/g},function(a){ThriveComments.util.tpl=function(b,c){var d=a("script#"+b.replace(/\//g,"-")).html()||"";return c?_.template(d)(c):_.template(d)},ThriveComments.util.nested=function(a,b){var c=this;return a instanceof Backbone.Model?this.nested(a.attributes,b):_.each(b,function(b){b.children&&(a[b.name]=c.nested(a[b.name],b.children)),_.isArray(a)?_.each(a,function(a){a[b.name]=new b.obj(a[b.name])}):a[b.name]=new b.obj(a[b.name])}),a},ThriveComments.util.validateInput=function(a,b,c){var d=a instanceof jQuery?a.val():a,e=!0;return d=d.trim(),""==d?(b||(b=ThriveComments.util.render_label("isRequired")),e=!1,a instanceof jQuery&&(a.removeClass("tcm-valid"),a.addClass("tcm-invalid"),a.prev(".tcm-error-message").show().html(b))):(a.removeClass("tcm-invalid"),a.prev(".tcm-error-message").hide(b)),e},ThriveComments.util.validateInputUrl=function(a,b,c){var d=a instanceof jQuery?a.val():a,e=!0;return void 0!=d&&0==this.isValidUrl(this.addHttp(d))?(b||(b=ThriveComments.util.render_label("isRequired")),e=!1,a instanceof jQuery&&(a.removeClass("tcm-valid"),a.addClass("tcm-invalid"),a.prev(".tcm-error-message").show().html(b))):(a.removeClass("tcm-invalid"),a.prev(".tcm-error-message").hide(b)),e},ThriveComments.util.validateStoringConsent=function(a,b){var c=a instanceof jQuery?a.is(":checked"):a,d=a.siblings(".tcm-consent-text"),e=ThriveComments.util.get_cookie("tcm_cookie_user_name"),f=!0;return""===ThriveComments.settings.storing_consent||0===ThriveComments.settings.storing_consent?f:(c||""!==e?(d.removeClass("tcm-not-selected"),a.prev(".tcm-error-message").hide(b)):(b||(b=ThriveComments.util.render_label("isRequired")),f=!1,a instanceof jQuery&&(d.removeClass("tcm-not-selected"),d.addClass("tcm-not-selected"),a.prev(".tcm-error-message").show().html(b))),f)},ThriveComments.util.validateEmail=function(a,b){var c=a.length?a.val():a;return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(c)?(a instanceof jQuery&&(a.removeClass("tcm-invalid"),a.prev(".tcm-error-message").hide()),!0):(a instanceof jQuery&&(a.removeClass("tcm-valid"),a.addClass("tcm-invalid"),a.prev(".tcm-error-message").show().html(b)),!1)},ThriveComments.util.valuesToArray=function(a){return Object.keys(a).map(function(b){return a[b]})},ThriveComments.util.set_avatar_url=function(a){a.length&&a.attr("data-src")===ThriveComments.default_author_picture_url&&this.checkGravatar(a.attr("data-email-hash")).done(function(b){a.css("background-image",'url("'+b+'")')})},ThriveComments.util.previousUser=function(){return""!==ThriveComments.util.get_cookie("social-login")||!!ThriveComments.current_user.ID||void 0},ThriveComments.util.set_cookie=function(a,b,c,d){d=d||"/",c=c||2592e3;var e,f=new Date;c=parseInt(c),f.setTime(f.getTime()+1e3*c),e=f.toUTCString(),"object"===(void 0===b?"undefined":_typeof(b))&&(b=JSON.stringify(b)),document.cookie=encodeURIComponent(a)+"="+b+";expires="+e+";path="+d},ThriveComments.util.get_cookie=function(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "==e.charAt(0);)e=e.substring(1);if(0==e.indexOf(b))return e.substring(b.length,e.length)}return""},ThriveComments.util.search_comment=function(a,b){return void 0!==a.models&&this.search_recursive(a.models,b)},ThriveComments.util.search_recursive=function(a,b){for(var c=0,d=0;!c&&d<a.length;d++)a[d].get("comment_ID")==b?c=a[d]:a[d].get("children")&&a[d].get("children").length&&(c=c||this.search_recursive(a[d].get("children"),b));return c},ThriveComments.util.elem_viewport=function(b){var c=b.offset(),d=c?c.top:0,e=d+b.outerHeight(),f=a(window).scrollTop(),g=f+a(window).height();return e>f&&d<g},ThriveComments.util.focusElement=function(b){var c=b.offset().top,d=b.height(),e=a(window).height(),f=void 0;f=d<e?c-(e/2-d/2):c,a("html, body").animate({scrollTop:f},300,"easeOutQuint")},ThriveComments.util.save_setting_model=function(a,b,c,d){if(!a)return!1;d=d||{},d.success||(d.success=ThriveComments.translations.settings_saved_success_toast),d.fail||(d.fail=ThriveComments.translations.settings_saved_fail_toast),new ThriveComments.models.Settings({name:a,value:b}).save().done(function(e){"NoMessage"!==d.success&&TVE_Dash.success(d.success),-1!==ThriveComments.tcm_sync_settings.indexOf(a)&&c.where({name:a}).shift().set("value",b)}).fail(function(a){TVE_Dash.err(d.fail)})},ThriveComments.util.render_label=function(a,b,c){var d,e,f,g,h,i;if(b||(b=""),!(d=window.parent.ThriveComments?void 0===window.parent.ThriveComments.objects.Settings?ThriveComments.tcm_customize_labels:window.parent.ThriveComments.objects.Settings.get(ThriveComments.tcm_labels_key).get("value"):ThriveComments.tcm_customize_labels)||!d.hasOwnProperty(a))return"";if(h=d[a].text,-1===h.indexOf("{"))return h;switch(f=h.indexOf("{"),g=h.indexOf("}"),c){case"before":i=h.substr(0,f);break;case"after":i=h.substr(g+1,h.length-1);break;default:e=h.substring(f,g+1),i=h.replace(e,b)}return i},ThriveComments.util.showCommentsNumber=function(b){var c=a(".tcm-comments-number");c.length&&c.html(c.html().replace("comment_count",b)).show()},ThriveComments.util.tcm_show_loader=function(){a(".tcm-dot-loader").show()},ThriveComments.util.tcm_hide_loader=function(){a(".tcm-dot-loader").hide(),a(".thrive-comments-content").show()},ThriveComments.util.tcm_hide_textareas=function(b){var c=a(b.currentTarget).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-id");a("textarea[name=tcm-post-content]").each(function(){var b=a(this).closest(".tcm-comment-wrapper"),d=a(this).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-id"),e=b.find(".tcm-create-post-container").attr("data-position");void 0!==c&&a(this).closest(".comment-id-0").find(".tcm-comment-additional-fields").hide(),""!=e&&"top"===e||c==d||(a(this).closest(".tcm-comment-wrapper").slideUp(),a(this).closest(".tcm-reply-container").find(".tcm-reply-btn").attr("data-clicked",0))})},ThriveComments.util.after_ajax_login_actions=function(){a(".tcm-lazy-comments").empty(),a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},cache:!1,url:ThriveComments.routes.generate_nonce,dataType:"JSON",data:{action:"refresh_nonce"},type:"GET"}).done(function(b){var c=window.parent.ThriveComments.util.commentId,d=c?"comments/"+c:"";ThriveComments.current_user=b.current_user,ThriveComments.nonce=b.nonce,Backbone.history.loadUrl(d),a(".tcm-comment-item").each(function(){var b=a(this);b.find(".tcm-comment-wrapper").hide(),b.find(".tcm-error-heading").hide()})})},ThriveComments.util.focusAfterLogin=function(){if(this.commentId&&parseInt(this.commentId)===this.commentId){var b=a("div[data-comment-id="+this.commentId+"]");b.find(".tcm-reply-btn").click(),b.find("#tcm-post-content").val(this.content).focus()}if("bottom"===this.position){var c=a(".add-comment");c.click(),c.closest(".tcm-lazy-comments").find("textarea#tcm-post-content").val(this.content).focus()}"top"===this.position&&a("textarea#tcm-post-content").focus(),this.position=null},ThriveComments.util.scrollToElement=function(b){b.length&&a("body, html").animate({scrollTop:b.offset().top-a(window).height()/2+30},{duration:500,complete:function(){var a=b.parent();a.addClass("tcm-highlight-item"),setTimeout(function(){return a.removeClass("tcm-highlight-item")},800)}})},ThriveComments.util.showCommentConversion=function(a){var b=new ThriveComments.views.CommentConversion({commentView:a});b.handleAfterShowAction(),a.$el.prepend(b.$el)},ThriveComments.util.isValidUrl=function(a){return!(null===a.match(/(http(s)?:\/\/.)(www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&\/\/=]*)/g))},ThriveComments.util.addHttp=function(b){return b=a.trim(b),b&&!/^(?:f|ht)tps?\:\/\//.test(b)&&(b="http://"+b),b},ThriveComments.util.err=function(b,c,d){a(".tvd-toast").remove(),Toasts.init(b,c||3e3,"tvd-toast tvd-red",d,"bottom"),a(".tvd-toast").parent().addClass("tcm-frontend-toast")},ThriveComments.util.getDropDownItems=function(a){var b=void 0;if(a.meta_query.tcm_delegate)b={approve:1,unapprove:1,no_reply_needed:1,featured:1,delegate:1,spam:1,trash:1};else if(a.meta_query.tcm_featured)b={stop_featured:1,no_reply_needed:1,delegate:1};else switch(a.status){case"all":case"hold":case"tcm_unreplied":b={approve:1,unapprove:1,no_reply_needed:1,featured:1,delegate:1,spam:1,trash:1};break;case"featured":b={no_reply_needed:1,stop_featured:1,delegate:1};break;case"spam":b={not_spam:1,delete:1};break;case"trash":b={spam:1,restore:1,delete:1}}return b},ThriveComments.util.dynamicSortByProperty=function(a){var b=1;return"-"===a[0]&&(b=-1,a=a.substr(1)),function(c,d){return(c[a]<d[a]?-1:c[a]>d[a]?1:0)*b}},ThriveComments.util.insertAtCaret=function(a,b){if(a.length){var c=a[0],d=c.scrollTop,e=0,f=c.selectionStart||"0"==c.selectionStart?"ff":!!document.selection&&"ie";if("ie"==f){c.focus();var g=document.selection.createRange();g.moveStart("character",-c.value.length),e=g.text.length}else"ff"==f&&(e=c.selectionStart);var h=c.value.substring(0,e),i=c.value.substring(e,c.value.length);if(c.value=h+b+i,e+=b.length,"ie"==f){c.focus();var j=document.selection.createRange();j.moveStart("character",-c.value.length),j.moveStart("character",e),j.moveEnd("character",0),j.select()}else"ff"==f&&(c.selectionStart=e,c.selectionEnd=e,c.focus());c.scrollTop=d}},ThriveComments.util.ajaxurl=function(a){var b=-1!==ajaxurl.indexOf("?")?"&":"?";return a&&a.length?(a=a.replace(/^(\?|&)/,""),a+="&_nonce="+ThriveComments.admin_nonce,ajaxurl+b+a):ajaxurl+b+"_nonce="+ThriveComments.admin_nonce},ThriveComments.util.toCamelCase=function(a){return a=a.replace(/_/g," "),a.toLowerCase().replace(/(?:(^.))/g,function(a){return a.charAt(a.length-1).toUpperCase()})},ThriveComments.util.formatSelection=function(a){var b=a instanceof jQuery?a[0]:document.getElementById(a),c=void 0,d=void 0,e=void 0;if(void 0!==document.selection){b.focus();c=document.selection.createRange().text}else void 0!==b.selectionStart&&(d=b.selectionStart,e=b.selectionEnd,c=b.value.substring(d,e));return{selectedText:c,startPos:d,endPos:e}},ThriveComments.util.set_subscriber_cookies=function(a){var b=ThriveComments.util.get_cookie("subscribed_posts");if(""!==b&&(b=JSON.parse(b)),0===a){var c=b.indexOf(ThriveComments.post.ID);c>-1&&(b.splice(c,1),ThriveComments.util.set_cookie("subscribed_posts",JSON.stringify(b),31104e3))}else""===b?b=[ThriveComments.post.ID]:b.push(ThriveComments.post.ID),ThriveComments.util.set_cookie("subscribed_posts",JSON.stringify(b),31104e3)},ThriveComments.util.checkGravatar=function(b){var c=this,d=a.Deferred();if(this.gravatarCache=this.gravatarCache||{},this.gravatarCache[b])this.gravatarCache[b].success?d.resolve(this.gravatarCache[b].url):d.reject();else{var e="https://www.gravatar.com/avatar/"+b+"?s=512";a.ajax({type:"HEAD",url:e+"&d=404"}).done(function(a){c.gravatarCache[b]={url:e,success:!0},d.resolve(e)}).fail(function(){c.gravatarCache[b]={url:"",success:!1},d.reject()})}return d}}(jQuery);var ThriveComments=ThriveComments||{};ThriveComments.models=ThriveComments.models||{},ThriveComments.collections=ThriveComments.collections||{},function(a){ThriveComments.models.Base=Backbone.Model.extend({idAttribute:"comment_ID",sync:function(a,b,c){var d;return c=c||{},c.cache=!1,_.isUndefined(ThriveComments.nonce)||_.isNull(ThriveComments.nonce)||(d=c.beforeSend,c.beforeSend=function(a){if(a.setRequestHeader("X-WP-Nonce",ThriveComments.nonce),d)return d.apply(this,arguments)}),Backbone.sync(a,b,c)}}),ThriveComments.collections.Base=Backbone.Collection.extend({sync:function(a,b,c){var d;return c=c||{},c.cache=!1,c.url=this.url(),_.isUndefined(ThriveComments.nonce)||_.isNull(ThriveComments.nonce)||(d=c.beforeSend,c.beforeSend=function(a){if(a.setRequestHeader("X-WP-Nonce",ThriveComments.nonce),d)return d.apply(this,arguments)}),Backbone.sync(a,b,c)}}),ThriveComments.models.Settings=ThriveComments.models.Base.extend({idAttribute:"name",defaults:{name:"",value:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.Settings=ThriveComments.collections.Base.extend({model:ThriveComments.models.Settings,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.Badges=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",awarded:"",reaches:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.Badges=ThriveComments.collections.Base.extend({model:ThriveComments.models.Badges,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.Keywords=ThriveComments.models.Base.extend({idAttribute:"name",defaults:{name:"",value:"",new_tab:"",no_follow:"",post_id:""},url:function(){return ThriveComments.routes.settings+"/keywords"}}),ThriveComments.collections.Keywords=ThriveComments.collections.Base.extend({model:ThriveComments.models.Keywords,url:function(){return ThriveComments.routes.settings+"/keywords"},parse:function(a){return _.map(a,function(a,b,c,d){return new ThriveComments.models.Keywords({name:a,value:b,new_tab:c,no_follow:d})})}}),ThriveComments.models.BadgeImage=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",url:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.BadgeImages=ThriveComments.collections.Base.extend({model:ThriveComments.models.BadgeImage,url:function(){return ThriveComments.routes.settings}}),ThriveComments.models.SignInButton=ThriveComments.models.Base.extend({idAttribute:"id",defaults:{id:"",name:"",status:"",url:""},url:function(){return ThriveComments.routes.settings}}),ThriveComments.collections.SignInButtons=ThriveComments.collections.Base.extend({model:ThriveComments.models.SignInButton,url:function(){return ThriveComments.routes.settings}})}(jQuery);var ThriveComments=ThriveComments||{};ThriveComments.views=ThriveComments.views||{},ThriveComments.objects=ThriveComments.objects||{},function(a){ThriveComments.views.Base=Backbone.View.extend({render:function(){return this._render(),TVE_Dash.materialize(this.$el),this}}),ThriveComments.views.Dashboard=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("dashboard"),events:{"click .tcm-checkbox":"saveSetting","change .tcm-input":"saveSetting","click .tcm-radio":"saveSetting","change .tcm-dropdown":"saveSetting","click .tcm-upload-image":"openUploadImage","click #tcm-revert-default":"revertDefault","click .tcm-gravatar-switch":"hideShowAvatarSettings","click #tcm-preview-header a":"hideShowLivePreview","click #comment_registration":"disableActivateLogin","click .tcm-conversion-menu":"showCommentConversion","click .size-s":"setSmall","click .size-l":"setBig","change .role-checkbox":"roleSetting","click .tcm-voting-card":"saveVotingSetting","click .tcm-badge-new":"addNewBadge","click #tcm-badges-option":"hideShowBadges","click #color-picker":"showColorPicker",click:"hideColorPicker","click #tcm_live_update":"show_live_update_refresh_rate"},initialize:function(a){this.listenTo(this.collection,"sync",this.render),this.labels=a.labels},_render:function(){this.$el.html(this.template({collection:this.collection,default_avatar:ThriveComments.default_avatar_url,roles:ThriveComments.thrive_roles})),TVE_Dash.materialize(this.$el);var b,c=this.$(".color-picker-container"),d=this.$(".color-picker"),e=this;return d.iris({width:250,defaultColor:!0,change:function(a,c){e.$(".color-picker-label").css("background-color",c.color.toString()),setTimeout(function(){performance.now()-b>500&&(ThriveComments.util.save_setting_model("tcm_color_picker_value",c.color.toString(),e.collection),b=performance.now())},800),b=performance.now()},target:c,hide:!1,palettes:!0}),d.iris("hide").iris("option","hide",!0),this.labels=new ThriveComments.views.Labels({el:this.$(".labels-container"),collection:this.collection}),ThriveComments.objects.CustomImagesCollection=this.collection.get("tcm_badges_custom_images").get("value"),ThriveComments.objects.CustomImagesCollection||(ThriveComments.objects.CustomImagesCollection=[]),ThriveComments.objects.BadgeImages=new ThriveComments.collections.BadgeImages(ThriveComments.badges_default),ThriveComments.objects.Badges=new ThriveComments.collections.Badges(this.collection.get("tcm_badges").get("value")),this.badges=new ThriveComments.views.BadgesCards({el:this.$(".tcm-badges-cards"),collection:ThriveComments.objects.Badges}),ThriveComments.objects.SocialSignInButtons=new ThriveComments.collections.SignInButtons(ThriveComments.tcm_social_apis),this.social=new ThriveComments.views.SignInButtons({el:this.$("#tcm-social-status"),collection:ThriveComments.objects.SocialSignInButtons,settings_api:this.collection.get("tcm_api_status").get("value")}),ThriveComments.objects.Keywords=new ThriveComments.collections.Keywords(this.collection.get("tcm_keywords").get("value")),this.keywords=new ThriveComments.views.Keywords({el:this.$(".keywords-container"),collection:ThriveComments.objects.Keywords}),this.notifications=new ThriveComments.views.Notifications({el:this.$(".tcm-notifications"),collection:this.collection}),this.notifications.render(),ThriveComments.objects.SocialSignInButtons=new ThriveComments.collections.SignInButtons([]),ThriveComments.tcm_hide_live_preview.length>0&&a(".tcm-preview-slider").trigger("click"),this.stickySidebar(),this},showColorPicker:function(){a(".color-picker").iris("show")},hideColorPicker:function(b){var c=a(b.target);c.hasClass("color-picker-container")||c.closest(".color-picker-container").length>0||a("#color-picker").is(":focus")||a(".color-picker").iris("hide")},show_live_update_refresh_rate:function(){this.$(".tcm_live_update_refresh_rate").toggleClass("tcm-hide")},stickySidebar:function(){a(window).scroll(function(){var b=a(window).scrollTop();a("#tcm-live-preview").toggleClass("sticky",b>=78)})},setSmall:function(b){a(b.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","large")&&(a("#tcm-live-preview").animate({width:360}),a("#tcm-admin-configurator").animate({width:a("#tcm-holder").width()-360}),a("#tcm-preview-header span").removeClass("active"),a(b.currentTarget).addClass("active"),a(b.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","small"),a("iframe.live-preview").contents().find("#thrive-comments").removeClass("tcm-large-preview").addClass("tcm-small-preview"))},setBig:function(b){a(b.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","small")&&(a("#tcm-live-preview").animate({width:460}),a("#tcm-admin-configurator").animate({width:a("#tcm-holder").width()-460}),a("#tcm-preview-header span").removeClass("active"),a(b.currentTarget).addClass("active"),a(b.currentTarget).parents("#tcm-preview-header").children("a").attr("data-size","large"),a("iframe.live-preview").contents().find("#thrive-comments").removeClass("tcm-small-preview").addClass("tcm-large-preview"))},hideShowLivePreview:function(a){var b=this.$("#tcm-live-preview"),c=this.$("#tcm-admin-configurator"),d=this.$("#tcm-holder");return this.$(".tcm-icon-keyboard_arrow_down").toggleClass("icon-variation"),b.find("#tcm-preview-header a").toggleClass("icon-box-position"),a.currentTarget.getAttribute("data-hide")?a.currentTarget.getAttribute("data-hide")&&("large"==a.currentTarget.getAttribute("data-size")?c.animate({width:d.width()-460}):c.animate({width:d.width()-360}),b.animate({right:"0"}),a.currentTarget.removeAttribute("data-hide"),ThriveComments.util.save_setting_model("tcm_hide_live_preview",!1)):("large"==a.currentTarget.getAttribute("data-size")?b.animate({right:-460}):b.animate({right:-360}),c.animate({width:"100%"}),0===ThriveComments.tcm_hide_live_preview.length&&ThriveComments.util.save_setting_model("tcm_hide_live_preview",!0),a.currentTarget.setAttribute("data-hide",1)),!1},saveSetting:function(a){var b=a.currentTarget.dataset.type,c="",d="",e=a.currentTarget.dataset.setting;switch(b){case"checkbox":c=a.currentTarget.checked;break;case"number":var f=parseInt(this.$("#"+e).val());if(!new RegExp("^[0-9]+$").test(f)||""===f||0===f||f>1e4)return TVE_Dash.err("This input only accepts digits between 1 and 10000"),a.currentTarget.value=a.currentTarget.getAttribute("value"),!1;a.currentTarget.setAttribute("value",f),c=f;break;case"dropdown":d=document.getElementById("sorting_type"),c=d.options[d.selectedIndex].value;break;case"radio":c=e===ThriveComments.const.absolute_date||e===ThriveComments.const.light_design?1:e===ThriveComments.const.relative_date||e===ThriveComments.const.dark_design?2:0,e=e===ThriveComments.const.absolute_date||e===ThriveComments.const.relative_date||e===ThriveComments.const.hide_date?"comment_date":"comment_style_template";break;case"textarea":c=this.$("#"+e).val()}ThriveComments.util.save_setting_model(e,c,this.collection)},revertDefault:function(a){ThriveComments.util.save_setting_model(a.currentTarget.dataset.setting,ThriveComments.default_avatar_url,this.collection),this.afterImageSave(1)},openUploadImage:function(){var a=this,b=wp.media({title:ThriveComments.translations.choose_avatar,button:{text:ThriveComments.translations.choose_avatar_button},library:{type:"image"},multiple:!1,frame:"select"});b.on("select",function(){var c=b.state().get("selection").first().toJSON();ThriveComments.util.save_setting_model("tcm_default_picture",c.url,a.collection),a.$(".tcm-upload-div").css("background-image",c.url),a.afterImageSave(0,c.url)}),b.open()},afterImageSave:function(a,b){a?(this.$(".tcm-upload-div").css("background-image","url("+ThriveComments.default_avatar_url+")"),this.$("#tcm-revert-default").attr("disabled",!0),this.$("#tcm-upload-image").html(ThriveComments.translations.choose_image),this.$(".tcm-selected-image").html(ThriveComments.translations.default_avatar)):(this.$("#tcm-revert-default").attr("disabled",!1),this.$("#tcm-upload-image").html(ThriveComments.translations.change_image),this.$(".tcm-upload-div").css("background-image","url("+b+")"),this.$(".tcm-selected-image").html(ThriveComments.translations.selected_image+": "+b.substr(b.lastIndexOf("/")+1)))},hideShowAvatarSettings:function(a){var b=this.$(".tcm-avatar-settings");if(a.currentTarget.checked)return b.show(),!0;b.hide()},disableActivateLogin:function(a){var b=this.$("#login_activation"),c=this.$("#login_activation_label");this.$("#comment_registration").is(":checked")?(b.is(":checked")||ThriveComments.util.save_setting_model("login_activation",1,this),c.addClass("tcm-disabled"),b.prop("checked",!0),b.prop("disabled",!0)):(b.prop("disabled",!1),c.removeClass("tcm-disabled"))},showCommentConversion:function(a){if(!this.conversionView){var b=jQuery(a.currentTarget);return b.addClass("tvd-active"),b.find(".tvd-collapsible-header").addClass("tvd-active"),this.conversionView=new ThriveComments.views.Conversion({collection:this.collection}),b.append(this.conversionView.$el),this.conversionView.$el.slideDown(),!1}},roleSetting:function(a){var b=a.currentTarget.dataset.setting,c=a.currentTarget.checked;c=c?1:0,ThriveComments.util.save_setting_model(b,c,this.collection)},saveVotingSetting:function(b){var c=b.currentTarget.getAttribute("data-value"),d=this.$(".elemToggle");a(".tcm-voting-card").removeClass("current"),b.currentTarget.classList.add("current"),ThriveComments.util.save_setting_model("tcm_vote_type",c,this.collection,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast}),this.saveCommentOrderSetting(c),"no_vote"===c?d.hide():d.show()},saveCommentOrderSetting:function(a){var b="no_vote"===a?"desc":"top_rated";ThriveComments.util.save_setting_model("comment_order",b,this.collection,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast})},addNewBadge:function(){ThriveComments.objects.NewBadge=new ThriveComments.models.Badges({id:0,name:ThriveComments.translations.badge_default_title,awarded:"asc",reaches:"10"}),TVE_Dash.modal(ThriveComments.views.BadgeModal,{badge:ThriveComments.objects.NewBadge,"max-width":"40%"})},hideShowBadges:function(a){var b=a.currentTarget.checked,c=this.$(".tcm-badges-wrapper");!0===b?c.show():c.hide()}}),ThriveComments.views.Conversion=ThriveComments.views.Base.extend({className:"tvd-collapsible-body",template:ThriveComments.util.tpl("comment-conversion"),events:{"click .tcm-cards .tcm-card":"clickTab","focusout textarea":"saveConversionSetting","focusout .redirect_url":"redirect","click .tcm-checkbox":"saveConversionSetting","change .tcm-select-thrivebox":"saveConversionSetting","click .social-share-checkbox":"verifyCheckboxes","mousedown .tcm-hyperlink":"openHyperLink"},initialize:function(a){this.allSettings=a.collection,this.conversionSettings=a.collection.get("tcm_conversion").get("value"),this.render()},_render:function(){return this.$el.html(this.template({conversionSettings:this.conversionSettings})),this.initTooltips(),this.initThriveBoxes(),this.initRedirect(),this.initVerification(),this},clickTab:function(b){a(b.currentTarget).hasClass("leads_inactive")||(this.updateActiveCard(b),this.showHideTabs(b))},initThriveBoxes:function(){ThriveComments.leads_active&&(this.renderThriveBoxes(this.$("#thrive-boxes-first-time")),this.renderThriveBoxes(this.$("#thrive-boxes-second-time")))},renderThriveBoxes:function(a){a.select2({minimumResultsForSearch:2})},initTooltips:function(){var b=this.getTooltipMessage();this.$(".tooltips").each(function(){var c=a(this);c.hasClass("leads_inactive")&&this.setAttribute("data-powertip",b),c.powerTip({placement:"n",smartPlacement:!0,mouseOnToPopup:!0})})},getTooltipMessage:function(){return ThriveComments.translations.conversion_leads_availabe+' <a href="https://thrivethemes.com/leads/"  target="_blank">Thrive Leads</a> '+ThriveComments.translations.conversion_leads_installed},showHideTabs:function(b){var c=a(b.currentTarget),d=c.attr("data-tab");c.siblings().removeClass("current"),c.parent().siblings(".tcm-message-container").children(".tcm-message-box").removeClass("current"),c.addClass("current"),c.parent().siblings(".tcm-message-container").children("#"+d).addClass("current")},updateActiveCard:function(a){var b=jQuery(a.currentTarget).parent().data("conversion-setting");this.conversionSettings[b].active=a.currentTarget.getAttribute("data-card"),ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings,{success:ThriveComments.translations.options_saved_success_toast,fail:ThriveComments.translations.options_saved_fail_toast})},saveConversionSetting:function(a){var b=a.currentTarget.getAttribute("data-card");b in this&&"function"==typeof this[b]&&this[b](a),ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings)},live_update:function(a){var b=a.currentTarget.getAttribute("data-conversion-setting");this.conversionSettings.tcm_live_update[b].custom_message=a.currentTarget.value},social_share:function(a){var b=a.currentTarget.getAttribute("data-conversion-setting");"checkbox"===a.currentTarget.type?this.conversionSettings.tcm_social_share[b].social_sharing_buttons[a.currentTarget.name]=a.currentTarget.checked?1:0:this.conversionSettings.tcm_social_share[b].custom_message=a.currentTarget.value},related_posts:function(a){var b=a.currentTarget.getAttribute("data-conversion-setting");"checkbox"===a.currentTarget.type?this.conversionSettings.tcm_related_posts[b].show_featured_image=a.currentTarget.checked?1:0:this.conversionSettings.tcm_related_posts[b].custom_message=a.currentTarget.value},tcm_thrivebox:function(b){var c=b.currentTarget.getAttribute("data-conversion-setting");this.conversionSettings.tcm_thrivebox[c].thrivebox_id=b.currentTarget.value,"0"===b.currentTarget.value?a(b.currentTarget).next().next().show():a(b.currentTarget).next().next().hide()},redirect:function(a){var b,c;"redirect_url"==a.target.id?(b="first_time",c="#redirect-error"):(b="second_time",c="#redirect-error2");var d=a.currentTarget.value,e=ThriveComments.util.addHttp(d),f=this.conversionSettings.tcm_redirect[b].redirect_post_val,g=this.conversionSettings.tcm_redirect[b].redirect_url;if(0==a.currentTarget.getAttribute("data-flag")||d==g||d==f)return void(""==d&&this.$(c).show());if(!ThriveComments.util.isValidUrl(e)){this.conversionSettings.tcm_redirect[b].flag=1,this.conversionSettings.tcm_redirect[b].redirect_post_val=d;var h="tcm_conversion",i=this.conversionSettings,j=this.allSettings;return new ThriveComments.models.Settings({name:h,value:i}).save().done(function(a){-1!==ThriveComments.tcm_sync_settings.indexOf(h)&&j.where({name:h}).shift().set("value",i)}).fail(function(a){TVE_Dash.err(ThriveComments.translations.settings_saved_fail_toast)}),void this.$(c).show()}this.conversionSettings.tcm_redirect[b].redirect_url=e,this.conversionSettings.tcm_redirect[b].flag=0,this.conversionSettings.tcm_redirect[b].redirect_post_id=0,ThriveComments.util.save_setting_model("tcm_conversion",this.conversionSettings,this.allSettings),this.$(c).hide()},getPostNameById:function(b,c){var d=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:d,type:"POST",data:{postId:b}}).done(function(b){"first_time"==c&&a("#redirect_url").removeClass("ui-autocomplete-loading"),"second_time"==c&&a("#redirect_url2").removeClass("ui-autocomplete-loading")}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)}).always(function(){TVE_Dash.hideLoader()})},redirectAutocomplete:function(b,c,d,e){var f,g,h=this;"first_time"==e?(f="#redirect_url",g="#redirect-error"):(f="#redirect_url2",g="#redirect-error2"),d.autocomplete({delay:50,select:function(a,b){h.conversionSettings.tcm_redirect[e].redirect_post_id=b.item.id,h.conversionSettings.tcm_redirect[e].redirect_post_val=b.item.value,h.conversionSettings.tcm_redirect[e].redirect_url=c[0]+"//"+c[2]+"?p="+b.item.id,h.conversionSettings.tcm_redirect[e].flag=0,h.$(f)[0].setAttribute("data-flag",0),ThriveComments.util.save_setting_model("tcm_conversion",h.conversionSettings,h.allSettings),h.$(g).hide()},source:function(c,d){a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:b,dataType:"json",data:{q:c.term},type:"POST"}).done(function(a){h.$(f)[0].setAttribute("data-flag",1),h.conversionSettings.tcm_redirect[e].flag=1,d(a)}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)})}})},redirectInitInput:function(a,b){0==this.conversionSettings.tcm_redirect[b].redirect_post_id?a.val(this.conversionSettings.tcm_redirect[b].redirect_url):a.val(this.conversionSettings.tcm_redirect[b].redirect_post_val),1==this.conversionSettings.tcm_redirect[b].flag&&(a.val(this.conversionSettings.tcm_redirect[b].redirect_post_val),"first_time"==b?this.$("#redirect-error").show():this.$("#redirect-error2").show())},initRedirect:function(){this.redirectInitInput(this.$("#redirect_url"),"first_time"),this.redirectInitInput(this.$("#redirect_url2"),"second_time");var a=ThriveComments.routes.settings+"/redirect_autocomplete",b=location.href.split("/"),c=this.$(".tcm-autocomplete"),d=this.$(".tcm-autocomplete2");this.redirectAutocomplete(a,b,c,"first_time"),this.redirectAutocomplete(a,b,d,"second_time"),this.getPostNameById(this.conversionSettings.tcm_redirect.first_time.redirect_post_id,"first_time"),this.getPostNameById(this.conversionSettings.tcm_redirect.second_time.redirect_post_id,"second_time")},verifyCheckboxes:function(b){var c=a(b.target).parents(".social-sharing-checkboxes").find(".social-share-checkbox:checked")
;1==c.length?c.prop("disabled",!0):c.prop("disabled",!1)},initVerification:function(){var a=this.$(".first-case").find(".social-share-checkbox:checked"),b=this.$(".second-case").find(".social-share-checkbox:checked");1==a.length&&a.prop("disabled",!0),1==b.length&&b.prop("disabled",!0)},openHyperLink:function(b){var c=a(b.currentTarget).parent().parent().find("textarea"),d=a(b.currentTarget).next();this.hyperlink&&this.hyperlink.closeHyperLink(),this.hyperlink=new ThriveComments.views.HyperLink({el:d,input:c,selected_text:ThriveComments.util.formatSelection(c.attr("id"))}),d.show().addClass("dropdown")}}),ThriveComments.views.Labels=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("labels"),events:{"click .tcm-save-labels":"saveLabels","click .tcm-discard-changes":"discardChanges","focus input":"highlightLabel","focusout input":"removeHighlight"},initialize:function(){this.render()},_render:function(){return this.$el.html(this.template({labels:this.collection.get(ThriveComments.tcm_labels_key).get("value")})),this},highlightLabel:function(a){var b=a.currentTarget;jQuery(b).parent().siblings().children("label").css("color","#0dbf9f")},removeHighlight:function(a){var b=a.currentTarget;jQuery(b).parent().siblings().children("label").css("color","#999")},saveLabels:function(a){var b=this.$("input.tcm-label"),c={};return b.each(function(){c[this.getAttribute("data-key")]={default:this.getAttribute("data-default"),text:this.value},this.setAttribute("data-attribute",this.value)}),ThriveComments.util.save_setting_model(ThriveComments.tcm_labels_key,c,this.collection),!1},discardChanges:function(){this.$("input.tcm_label").each(function(){this.value=this.getAttribute("data-attribute")})}}),ThriveComments.views.BadgeCard=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("badgecard"),events:{"click .tcm-delete-badge-button":"deleteBadge","click .tcm-edit-badge-button":"editBadge"},render:function(){return this.$el.html(this.template({testimonial:this.model})),this},deleteBadge:function(){TVE_Dash.modal(ThriveComments.views.BadgesDeleteModal,{badge:this.model,dismissible:!1})},editBadge:function(){TVE_Dash.modal(ThriveComments.views.BadgeModal,{badge:this.model,"max-width":"40%"})}}),ThriveComments.views.BadgesCards=ThriveComments.views.Base.extend({initialize:function(){this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"reset",this.render),this.render()},renderOne:function(a){var b=new ThriveComments.views.BadgeCard({model:a}),c=b.render().$el;this.$el.append(c)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this}}),ThriveComments.views.BadgeModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("badges-modal"),events:{"click .tcm-save-badges":"saveBadges","click .tcm-discard-changes":"discardChanges","click .tcm-upload-badge":"openUploadImage","click .tcm-badge-icon":"selectBadgeImage"},afterOpen:function(){new ThriveComments.views.BadgeImages({el:this.$(".badges-inner"),collection:ThriveComments.objects.BadgeImages,badge:this.badge});var b=a(".tcm-badges-container"),c=a(".selected");void 0!==c.offset()&&b.animate({scrollTop:c.offset().top-b.offset().top+b.scrollTop()-50,scrollLeft:0},300)},saveBadges:function(){var a={},b=ThriveComments.objects.Badges;if(a.id=this.$("#tcm_badge_id").data("id"),a.name=this.$("#tcm_badge_name").val(),a.awarded=this.$("#tcm_badge_awarded").val(),a.awarded_text=this.$("#tcm_badge_awarded option:selected").text(),a.reaches=this.$("#tcm_badge_reaches").val(),a.image=this.$(".tcm-badge-icon.selected").data("name"),a.image_url=this.$(".tcm-badge-icon.selected").data("url"),0==this.validateBadgeInput(a,b.models))return!1;if(a.reaches=parseInt(a.reaches),0==a.id){var c=(new Date).getTime(),d=c.toString(36);a.id=d,b.create(a)}else{b.get(a.id).set(a)}return ThriveComments.util.save_setting_model("tcm_badges",b,this.collection),this.close(),!1},openUploadImage:function(){var b=wp.media({title:ThriveComments.translations.choose_testimonial_image,button:{text:ThriveComments.translations.choose_testimonial_image_button},library:{type:"image"},multiple:!1,frame:"select"}),c=null;return b.on("select",function(){c=b.state().get("selection").first().toJSON();var d={id:ThriveComments.objects.BadgeImages.length+1,name:c.url.substr(c.url.lastIndexOf("/")+1),url:void 0===c.sizes.thumbnail?c.sizes.full.url:c.sizes.thumbnail.url},e=new ThriveComments.models.BadgeImage(d),f=a(".tcm-badges-container");ThriveComments.objects.BadgeImages.add(e),ThriveComments.objects.CustomImagesCollection.push(d.url),ThriveComments.util.save_setting_model("tcm_badges_custom_images",ThriveComments.objects.CustomImagesCollection,this.collection),a(".tcm-badge-icon").removeClass("selected"),a(a('[data-name="'+d.name+'"]')[0]).addClass("selected");var g=a(".selected");void 0!==g.offset()&&f.animate({scrollTop:g.offset().top-f.offset().top+f.scrollTop()-50,scrollLeft:0},300)}),b.open(),!1},selectBadgeImage:function(b){a(".tcm-badge-icon").removeClass("selected"),b.currentTarget.classList.add("selected")},discardChanges:function(){this.$("input.tcm_label").each(function(){this.value=this.getAttribute("data-attribute")})},validateBadgeInput:function(a,b){if(""===a.name)return TVE_Dash.err(ThriveComments.translations.badge_no_empty_name),!1;var c=a.reaches;return""===c||c!=parseInt(c)||!c.indexOf("0")||c<0?(TVE_Dash.err(ThriveComments.translations.badge_reaches_only_number),!1):void 0===a.image?(TVE_Dash.err(ThriveComments.translations.badge_select_image),!1):void 0===_.find(b,function(b){return b.get("id")!==a.id&&b.get("reaches")===parseInt(a.reaches)&&b.get("awarded")===a.awarded})||(TVE_Dash.err(ThriveComments.translations.badge_same_settings),!1)}}),ThriveComments.views.BadgesDeleteModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("badges-delete"),events:{"click .tcm-delete-yes":"yes","keypress .tcm-keywords-delete":"keyAction"},keyboardEvents:{enter:"enterAction"},enterAction:function(a){13==a.which&&(this.yes(),this.close())},yes:function(){this.badge.destroy({data:{id:this.badge.get("id"),name:"tcm_badges"},processData:!0,success:function(){TVE_Dash.success("Badge deleted successfully!")},error:function(){TVE_Dash.err("Error while deleting Badge")}})}}),ThriveComments.views.BadgeImage=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("badgeimage"),initialize:function(a){this.badge=a.badge},render:function(){return this.$el.html(this.template({badge_image:this.model,badge:this.badge})),this}}),ThriveComments.views.BadgeImages=ThriveComments.views.Base.extend({initialize:function(a){this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(this.collection,"reset",this.render),this.badge=a.badge,this.render()},renderOne:function(a){var b=new ThriveComments.views.BadgeImage({model:a,badge:this.badge}),c=b.render().$el;this.$el.append(c)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this}}),ThriveComments.views.SignInButton=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("signin-button"),events:{"click .tcm-api-button":"changeStatus"},initialize:function(a){this.settings_api=a.settings_api},render:function(){return this.$el.html(this.template({button:this.model,api_settings:this.settings_api})),this},changeStatus:function(a){var b=a.currentTarget.dataset.name,c=a.currentTarget.dataset.status,d=this.settings_api;if("unset"===c)return!1;d[b]=1-d[b],a.currentTarget.classList.contains("disabled")?(a.currentTarget.classList.remove("disabled"),a.currentTarget.classList.add("enabled"),a.currentTarget.setAttribute("data-label",ThriveComments.translations.label_enabled)):(a.currentTarget.classList.remove("enabled"),a.currentTarget.classList.add("disabled"),a.currentTarget.setAttribute("data-label",ThriveComments.translations.label_disabled)),ThriveComments.util.save_setting_model("tcm_api_status",d,this.settings_api)}}),ThriveComments.views.SignInButtons=ThriveComments.views.Base.extend({initialize:function(a){this.settings_api=a.settings_api,this.render()},renderOne:function(a){var b=new ThriveComments.views.SignInButton({model:a,settings_api:this.settings_api}),c=b.render().$el;this.$el.append(c)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this.checkApiStatus(),this},checkApiStatus:function(){var a=this;this.collection.each(function(b){"set"===b.attributes.status?a.settings_api[b.attributes.name.concat("_api")]=1:a.settings_api[b.attributes.name.concat("_api")]=0}),ThriveComments.util.save_setting_model("tcm_api_status",this.settings_api,this.settings_api,{success:"NoMessage",fail:"NoMessage"})}}),ThriveComments.views.LivePreview=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("comments-live-preview"),initialize:function(){this._render(),this.hideAdminBar(),this.collection.on("change",this._render,this)},_render:function(){this.$el.html(this.template({collection:this.collection}))},hideAdminBar:function(){a("#adminmenuwrap, #adminmenuback").hide(),a("#wpcontent").css({margin:0})}}),ThriveComments.views.Keywords=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("keywords"),events:{"click .add-keyword":"addKeyWord"},initialize:function(){this.render(),this.listenTo(this.collection,"remove",this.render),this.listenTo(this.collection,"add",this.render),this.listenTo(this.model,"change",this.render)},_render:function(){return this.$el.empty(),this.collection.each(this.renderOne,this),this.$el.append(this.template()),this},renderOne:function(a){var b=new ThriveComments.views.KeywordsItem({model:a}),c=b.render().$el;this.$el.append(c)},addKeyWord:function(){TVE_Dash.modal(ThriveComments.views.KeywordsModal,{collection:this.collection,keyword:new ThriveComments.models.Keywords({}),dismissible:!1})}}),ThriveComments.views.KeywordsItem=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("keywords-item"),events:{"click .tcm-edit-keyword":"editKeyWord","click .tcm-delete-keyword":"deleteKeyword"},initialize:function(){this.listenTo(this.model,"change",this.render)},_render:function(){return this.$el.html(this.template({keyword:this.model})),this},editKeyWord:function(){TVE_Dash.modal(ThriveComments.views.KeywordsModal,{keyword:this.model,dismissible:!1})},deleteKeyword:function(){TVE_Dash.modal(ThriveComments.views.KeywordsDeleteModal,{keyword:this.model,dismissible:!1})}}),ThriveComments.views.KeywordsModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("keywords-modal"),events:{"click .tcm-save-keyword":"saveKeyword"},keyboardEvents:{enter:"enterAction"},enterAction:function(a){13===a.which&&(this.saveKeyword(event),this.close())},afterRender:function(){this.$(".tvd-skip-modal-save").materialtags(),this.initAutocomplete()},saveKeyword:function(b){var c=this,d="",e=location.href.split("/"),f=this.$("#tcm_link").val(),g=this.$("#tcm_link")[0].getAttribute("data-flag"),h=this.$("#keyword_new_tab").is(":checked"),i=this.$("#keyword_no_follow").is(":checked");if(b.preventDefault(),_.each(a('span[class="tvd-chip"]'),function(b){var c=a(b).text();c=c.substring(0,c.length-5),c=c.replace(/\s+/g," "),c=c.replace(/^\s+|\s+$/g,""),d+=c+", "}),""===(d=d.substring(0,d.length-2)))return this.$("#keyword-error").show(),!1;if(this.$("#keyword-error").hide(),0!=g)f=e[0]+"//"+e[2]+"?p="+g;else{if(""===(f=ThriveComments.util.addHttp(f))||!ThriveComments.util.isValidUrl(f))return this.$("#link-error").show(),!1;this.$("#link-error").hide()}return this.keyword.set({name:d,value:f,new_tab:h,no_follow:i}),this.keyword.save().done(function(a){c.$el.closeModal(),c.collection?(c.collection.push(c.keyword),TVE_Dash.success(ThriveComments.translations.autolink_added)):TVE_Dash.success(ThriveComments.translations.autolink_changed),c.$el.empty(),c.unbind()}).fail(function(a){TVE_Dash.err(ThriveComments.translations.autolink_error)}),!1},getPostNameById:function(b){var c=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:c,type:"POST",data:{postId:b}}).done(function(b){a("#tcm_link").removeClass("ui-autocomplete-loading")}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)}).always(function(){TVE_Dash.hideLoader()})},LinkAutocomplete:function(b,c){var d=this;c.autocomplete({delay:50,select:function(a,b){d.$("#link-error").hide(),d.$("#tcm_link").first().attr("data-flag",b.item.id)},source:function(c,e){a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:b,dataType:"json",data:{q:c.term},type:"POST"}).done(function(a){d.$("#tcm_link").first().attr("data-flag",0),e(a)}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)})}})},initAutocomplete:function(){var a=ThriveComments.routes.settings+"/redirect_autocomplete",b=this.$(".tcm-autocomplete");this.LinkAutocomplete(a,b)}}),ThriveComments.views.KeywordsDeleteModal=TVE_Dash.views.Modal.extend({template:ThriveComments.util.tpl("keywords-delete"),events:{"click .tcm-delete-yes":"yes",keydown:"keyAction"},keyboardEvents:{enter:"enterAction",esc:"escapeAction"},enterAction:function(){this.yes(),this.close()},escapeAction:function(){this.close()},yes:function(){this.keyword.destroy({data:{name:"tcm_keywords",value:this.keyword.get("name")},processData:!0,success:function(){TVE_Dash.success("Auto-Link deleted successfully!")},error:function(){TVE_Dash.err("Error while deleting Auto-Link")}})}}),ThriveComments.views.Notifications=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("api-connections"),events:{"change .tcm-email-checkbox":"saveConnection","click .tcm-icon-mode_edit":"editNotifications"},render:function(){return this.$el.html(""),this.$el.html(this.template({collection:this.collection})),this.afterRender(),this},afterRender:function(){var b=this;a(".tcm-inactive-service-label").hide(),a(".tcm-service-label").each(function(){this.classList.contains("active")||(a(this).hide(),a(this).next().show())}),ThriveComments.LocalStorage.on("tve_new_api",function(a){if(-1!==ThriveComments.email_apis.indexOf(a.key)){var c=[];c.key=a.key,c.title=a.name,c.image=document.location.origin+"/wp-content/plugins/thrive-comments/thrive-dashboard/inc/auto-responder/views/images/"+a.key+"_small.jpg",c.active=0;if(void 0!==ThriveComments.email_services.find(function(b){if(b.key===a.key)return!0}))return!0;ThriveComments.email_services.push(c),b.render()}ThriveComments.LocalStorage.unset("tve_new_api")})},saveConnection:function(b){var c=a(b.currentTarget).parent().parent().next("p"),d=a(".tcm-service-label.active");if(b.currentTarget.checked){this.$(".tcm-email-checkbox").prop("checked",!1),a(b.currentTarget).prop("checked",!0),d.removeClass("active"),d.hide(),d.next().show(),c.show(),c.addClass("active"),c.next().hide();var e=b.currentTarget.dataset.setting;ThriveComments.util.save_setting_model("tcm_email_service",e,this.collection)}else a(".tcm-service-label").hide(),d.next().show(),ThriveComments.util.save_setting_model("tcm_email_service","",this.collection)},editNotifications:function(a){TVE_Dash.modal(ThriveComments.views.EditNotifications,{collection:this.collection,labels:this.collection.get("tcm_notification_labels").get("value"),view_type:a.target.id,dismissible:!1,className:"tvd-modal tcm-comments-notifications"})}}),ThriveComments.views.EditNotifications=TVE_Dash.views.Modal.extend({events:{"click .tcm-save-labels":"saveLabels","click .tcm-discard-changes":"discardChanges","click .tcm-customize-label":"showInput","keydown .tcm-input-label":"showLabel","click .tvd-modal-content":"hideInput","click .revert_notification_labels":"revertLabels","click .tcm-click-to-copy":"copyInput"},afterInitialize:function(a){this.template=ThriveComments.util.tpl(a.view_type);new Clipboard(".tcm-click-to-copy")},hideInput:function(b){if("textarea"!==b.target.type){var c=a(".tvd-modal-content").find(":input").filter(":visible");c.hide(),c.siblings("p").show().text(c.val())}},showLabel:function(b){var c=a(b.currentTarget),d=this.$(".unsubscribe-error-icon"),e=this.$(".button-error-icon");"unsubscribe_text"===b.currentTarget.id&&(""===c.val()?d.show():d.hide()),"unsubscribe-textarea"===b.currentTarget.id&&(""===c.val()?e.show():e.hide()),13===b.which&&(c.hide(),c.siblings("p").show().text(c.val())),27===b.which&&(c.hide(),c.siblings("p").show())},showInput:function(b){var c=a(".tvd-modal-content").find(":input").filter(":visible");return a(".label-customizing-div").removeClass("label-customizing-div"),c.hide(),c.siblings("p").show().text(c.val()),c=a(b.currentTarget),c.parent("div").addClass("label-customizing-div"),"A"===c.prop("nodeName")?(c.siblings("p").hide(),c.siblings("textarea").show().focus()):(c.hide(),c.next("textarea").show().focus()),!1},saveLabels:function(){var a=this.$("textarea.tcm_label"),b=this.labels;return!!this.validateLabels(a)&&(a.each(function(){b[this.dataset.key]={default:this.getAttribute("data-default"),text:this.value},this.setAttribute("data-attribute",this.value)}),ThriveComments.util.save_setting_model("tcm_notification_labels",b,this.collection),this.close(),!1)},validateLabels:function(a){var b=!0,c=this;return a.each(function(){"unsubscribe_text"===this.id&&(""===this.value||this.value.search(/{|}/)>-1)&&(c.$(".unsubscribe-error-icon").show(),b=!1),"unsubscribe-textarea"===this.id&&""===this.value&&(c.$(".button-error-icon").show(),b=!1)}),b},revertLabels:function(){var a=this.$("textarea.tcm_label"),b=this.labels;a.each(function(){b[this.dataset.key]={default:this.getAttribute("data-default"),text:this.getAttribute("data-default")},this.setAttribute("data-attribute",this.getAttribute("data-default"))}),ThriveComments.util.save_setting_model("tcm_notification_labels",b,this.collection),this.close()},copyInput:function(b){var c=a(b.currentTarget).text(),d=a(b.currentTarget);d.text(ThriveComments.translations.copy_input),setTimeout(function(){d.text(c)},500)}}),ThriveComments.views.HyperLink=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("moderation/hyperlink"),events:{"click .hyperlink-close":"closeHyperLink","click .hyperlink-save":"saveHyperLink"},initialize:function(a){this.parentView=a&&a.commentView?a.commentView:null,this.selected_text=a.selected_text,this.input=a.input,this.render()},render:function(){return this.$el.html(this.template({selected_text:this.selected_text.selectedText})),this.initAutocomplete(),this.disableSave(),this},closeHyperLink:function(){this.viewRemove(),a(".tcm-hyperlink-dropdown").hide().removeClass("dropdown")},disableSave:function(){var b=a("#tcm_hyperlink_url"),c=a(".hyperlink-save");b.bind("change keyup input",function(){""===b.val()?c.attr("disabled",!0):c.attr("disabled",!1)})},saveHyperLink:function(){var a=this.$("#hyperlink-error"),b=this.$("#hyperlink-new-tab"),c=this.$("#hyperlink-no-follow"),d=ThriveComments.util.addHttp(this.$("#tcm_hyperlink_url").val()),e=this.$("#tcm_hyperlink_text").val(),f=this.input;if(!ThriveComments.util.isValidUrl(d))return a.show(),!1;a.hide(),""===e&&(e=d);var g='<a href = "'+d+'"';if(b.is(":checked")&&(g+=' target="_blank"'),c.is(":checked")&&(g+=' rel="nofollow"'),g+=">"+e+"</a>",""===this.selected_text.selectedText)ThriveComments.util.insertAtCaret(f,g);else{var h=f.val();f.val(h.substring(0,this.selected_text.startPos)+g+h.substring(this.selected_text.endPos,h.length))}this.closeHyperLink()},getPostNameById:function(b){var c=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:c,type:"POST",data:{postId:b}}).done(function(b){a("#tcm_hyperlink").removeClass("ui-autocomplete-loading")}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)}).always(function(){TVE_Dash.hideLoader()})},LinkAutocomplete:function(b,c){var d=this,e=location.href.split("/");c.autocomplete({delay:50,select:function(a,b){return d.$("#link-error").hide(),d.$("#tcm_hyperlink_url").val(e[0]+"//"+e[2]+"?p="+b.item.id),d.$("#tcm_hyperlink_text").val(b.item.label),!1},source:function(c,d){a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:b,dataType:"json",data:{q:c.term},type:"POST"}).done(function(b){a("#hyperlink-error").hide(),d(b)}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)})}})},initAutocomplete:function(){var a=ThriveComments.routes.settings+"/redirect_autocomplete",b=this.$(".tcm-autocomplete");this.LinkAutocomplete(a,b)},viewRemove:function(){return this.$el.empty(),this.undelegateEvents(),this.unbind(),this}}),ThriveComments.views.Reporting=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/main"),events:{"change .tcm-report-select":"graphSelect","change .tcm-user-per-page":"changePage","click .clear-post-autocomplete":"postCleared","click .tcm-next-page":"nextPage","click .tcm-previous-page":"previousPage","change .tcm-change-users":"changeRows"},initialize:function(){this._render(),this.showCustomRange(),TVE_Dash.materialize(this.$el),a(".tcm-users-list-current-page").text("1"),this.initAutocomplete()},_render:function(){return this.$el.html(this.template({})),this.report=new ThriveComments.views.Report({el:this.$("#tcm-display-report")}),this},graphSelect:function(){var a=this;switch(this.$("#tcm-report-type option:selected").val()){case"vote_engagements":case"comments_graph":a.changeReport();break;case"most_active_commenters":this.changeReport(),void 0!==this.commenters&&this.commenters._render();break;case"most_popular_posts":this.changeReport(),void 0!==this.posts&&this.posts._render();break;case"most_upvoted":this.changeReport(),void 0!==this.upvoted&&this.upvoted._render();break;default:this.changeReport()}return!1},changeReport:function(){var b=this.$(".custom-range-date"),c=this.$("#tcm-report-type").val(),d=this.$("#tcm_report_autocomplete")[0].getAttribute("post_id"),e=this.$("#tcm_report_autocomplete")[0].getAttribute("tva_term"),f=this.$("#tcm-report-date").val(),g=this.$("#tcm-report-graph").val(),h=this.$("#tcm-report-start-date").val(),i=this.$("#tcm-report-end-date").val(),j=a("#tcm_report_autocomplete").val(),k=a("#tcm-report-type").val(),l=a("#tcm-include-moderators").is(":checked")?1:0;if(i){if("custom_range"===f){if(b.show(),!h||!i)return}else b.hide();var m={name:c,graph_source:d,report_source:j,date_interval:f,date_before:i,date_after:h,graph_interval:g,graph_title:k,tva_term:e,include_moderators:l};this.getReport(m)}},showCustomRange:function(){this.$el.find("#tcm-report-start-date").pickadate({max:!0,format:"yyyy-mm-dd",onStart:function(){var a=new Date;this.set("select",[a.getFullYear(),a.getMonth()+1,a.getDate()-7])}}),this.$el.find("#tcm-report-end-date").pickadate({max:!0,format:"yyyy-mm-dd",onStart:function(){var a=new Date;this.set("select",[a.getFullYear(),a.getMonth()+1,a.getDate()])}})},getReport:function(b){var c=this;this.showOverlay(),a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},cache:!1,dataType:"JSON",url:ThriveComments.routes.reporting,type:"POST",data:b}).done(function(a,d,e){"comments_graph"===b.name||"vote_engagements"===b.name?c.renderChart(a,b):"most_active_commenters"===b.name?c.activeCommenters(a):"most_popular_posts"===b.name?c.popularPosts(a):"most_upvoted"===b.name&&c.upvotedComments(a),c.hideOverlay()}).fail(function(){})},activeCommenters:function(b){a(".most_popular_post_header").hide(),a("#most_upvoted").hide(),a(".most_active_commenters_header").show(),a("#tcm-reporting-autocomplete").hide(),a("#tcm-display-report").hide(),a(".tcm-graph-interval").hide(),a(".tcm-reports-pagination").show(),a("#active_commenters_graph").show(),a(".most_upvoted_comments_header").hide(),b.length?(a(".tcm-no-data-report").hide(),a(".tcm-reporting-navigation").show()):(a(".tcm-no-data-report").show(),a(".tcm-reporting-navigation").hide()),this.commenters=new ThriveComments.views.Commenters({el:this.$("#most_active_commenters"),commenters:b}),this.commenters._render()},popularPosts:function(b){a(".most_active_commenters_header").hide(),a("#tcm-reporting-autocomplete").hide(),a("#tcm-display-report").hide(),a(".tcm-graph-interval").hide(),a(".tcm-reports-pagination").show(),a("#active_commenters_graph").show(),a(".most_upvoted_comments_header").hide(),a("#most_upvoted").hide(),a(".most_popular_post_header").show(),b.length?(a(".tcm-no-data-report").hide(),a(".tcm-reporting-navigation").show()):(a(".tcm-no-data-report").show(),a(".tcm-reporting-navigation").hide()),this.posts=new ThriveComments.views.Posts({el:this.$("#most_active_commenters"),posts:b}),this.posts._render()},upvotedComments:function(b){a(".most_popular_post_header").hide(),a(".most_active_commenters_header").hide(),a("#tcm-reporting-autocomplete").hide(),a("#tcm-display-report").hide(),a(".tcm-graph-interval").hide(),a(".tcm-reports-pagination").show(),a("#active_commenters_graph").show(),a(".most_upvoted_comments_header").show(),Object.keys(b).length?(a(".tcm-no-data-report").hide(),a(".tcm-reporting-navigation").show()):(a(".tcm-no-data-report").show(),a(".tcm-reporting-navigation").hide()),this.upvoted=new ThriveComments.views.Upvoted({el:this.$("#most_active_commenters"),comments:b}),this.upvoted._render()},renderChart:function(b,c){a(".most_active_commenters_header").hide(),a(".most_popular_post_header").hide(),a("#tcm-display-report").show(),a(".tcm-no-data-report").show(),a(".tcm-reports-pagination").hide(),a(".tcm-graph-interval").show(),a("#tcm-reporting-autocomplete").show(),a("#active_commenters_graph").hide();var d=[],e=0;a.each(b,function(b,c){var f={data:[]};f.name=b,a.each(c,function(a,b){var c=b.date;f.data.push([c,b[f.name]]),e+=b[f.name]}),f.name=f.name.replace("_comments",""),d.push(f)});var f=d[0].data.length;if(!e)return void a(".tcm-no-data-report").show();a(".tcm-no-data-report").hide(),""===c.report_source&&(c.report_source=ThriveComments.translations.entire_website),"vote_engagements"===c.graph_title?c.ytitle=ThriveComments.translations.nr_votes:c.ytitle=ThriveComments.translations.nr_comments,a("#tcm-report-container").highcharts({title:{text:ThriveComments.util.toCamelCase(c.graph_title)},subtitle:{text:"Source: "+c.report_source},yAxis:{title:{text:c.ytitle},min:0},xAxis:{type:"category",tickInterval:f>13?Math.ceil(f/13):1,title:{text:"Date"}},legend:{layout:"vertical",align:"right",verticalAlign:"middle"},plotOptions:{series:{label:{connectorAllowed:!1}}},series:d,responsive:{rules:[{condition:{maxWidth:500},chartOptions:{legend:{layout:"horizontal",align:"center",verticalAlign:"bottom"}}}]}})},getPostNameById:function(b){var c=ThriveComments.routes.settings+"/get_post_name_by_id";jQuery.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:c,type:"POST",data:{postId:b}}).done(function(b){a("#tcm_link").removeClass("ui-autocomplete-loading")}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)}).always(function(){TVE_Dash.hideLoader()})},LinkAutocomplete:function(b,c){var d=this;c.autocomplete({delay:50,select:function(b,e){c[0].setAttribute("post_id",e.item.id),!0===e.item.tva_term?c[0].setAttribute("tva_term",e.item.tva_term):c[0].setAttribute("tva_term",!1),a("#tcm_report_autocomplete").val(e.item.value),d.changeReport()},source:function(e,f){d.$(".clear-post-autocomplete").show(),a.ajax({headers:{"X-WP-Nonce":ThriveComments.nonce},url:b,dataType:"json",data:{q:e.term},type:"POST"}).done(function(a){c[0].setAttribute("post_id",0),f(a)}).fail(function(a){TVE_Dash.err(JSON.parse(a.responseText).message)})}})},initAutocomplete:function(){var a=ThriveComments.routes.settings+"/redirect_autocomplete",b=this.$("#tcm_report_autocomplete");this.LinkAutocomplete(a,b)},postCleared:function(b){b.currentTarget.style.display="none",this.$("#tcm_report_autocomplete").val(""),a("#tcm_report_autocomplete")[0].setAttribute("post_id",0),this.changeReport()},changeRows:function(){a(".tcm-users-list-current-page").text("1"),"most_active_commenters"===a("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===a("#tcm-report-type").val()?this.posts._render():this.upvoted._render()},nextPage:function(){var b=this.$(".tcm-users-list-current-page"),c=this.$(".tcm-users-list-total-pages");parseInt(b.text())<parseInt(c.text())&&(b.text(parseInt(b.text())+1),"most_active_commenters"===a("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===a("#tcm-report-type").val()?this.posts._render():this.upvoted._render())},previousPage:function(){var b=this.$(".tcm-users-list-current-page");parseInt(b.text())>1&&(b.text(parseInt(b.text())-1),"most_active_commenters"===a("#tcm-report-type").val()?this.commenters._render():"most_popular_posts"===a("#tcm-report-type").val()?this.posts._render():this.upvoted._render())},showOverlay:function(){this.$(".tcm-reporting-loader").show()},hideOverlay:function(){this.$(".tcm-reporting-loader").hide()}}),ThriveComments.views.Upvoted=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/comment"),events:{},initialize:function(b){this.comments=b.comments,a(".tcm-users-list-current-page").text("1")},_render:function(){var b=Object.keys(this.comments).length,c=parseInt(a("#tcm-user-per-page").val()),d=parseInt(a(".tcm-users-list-current-page").text());d||(a(".tcm-users-list-current-page").text("1"),d=1);var e=(d-1)*c,f=d*c;this.$el.empty();for(var g=e;g<Math.min(f,b);g++){var h=this.comments[g];this.$el.append(this.template({model:h}))}return a(".tcm-users-list-total-pages").text(Math.max(Math.ceil(b/c),1)),this}}),ThriveComments.views.Commenters=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/commenter"),events:{},initialize:function(b){this.commenters=b.commenters,a(".tcm-users-list-current-page").text("1")},_render:function(){var b=this.commenters.length,c=parseInt(a("#tcm-user-per-page").val()),d=parseInt(a(".tcm-users-list-current-page").text());d||(a(".tcm-users-list-current-page").text("1"),d=1);var e=(d-1)*c,f=d*c;this.$el.empty();for(var g=e;g<Math.min(f,b);g++){var h=this.commenters[g];this.$el.append(this.template({model:h}))}return a(".tcm-users-list-total-pages").text(Math.max(Math.ceil(this.commenters.length/c),1)),this}}),ThriveComments.views.Posts=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/post"),events:{},initialize:function(b){this.posts=b.posts,a(".tcm-users-list-current-page").text("1")},_render:function(){var b=this.posts.length,c=parseInt(a("#tcm-user-per-page").val()),d=parseInt(a(".tcm-users-list-current-page").text());d||(a(".tcm-users-list-current-page").text("1"),d=1);var e=(d-1)*c,f=d*c;this.$el.empty();for(var g=e;g<Math.min(f,b);g++){var h=this.posts[g];this.$el.append(this.template({model:h}))}return a(".tcm-users-list-total-pages").text(Math.max(Math.ceil(this.posts.length/c),1)),this}}),ThriveComments.views.Report=ThriveComments.views.Base.extend({template:ThriveComments.util.tpl("reporting/report"),events:{"change .tcm-report-select":"changeSELECT"},initialize:function(){this._render(),TVE_Dash.materialize(this.$el)},_render:function(){return this.$el.html(this.template({})),this}})}(jQuery);var ThriveComments=ThriveComments||{};ThriveComments.objects=ThriveComments.objects||{},Backbone.emulateHTTP=!0,function(a){var b=Backbone.Router.extend({view:null,$el:a("#tcm-admin-wrapper"),routes:{livePreview:"livePreview",dashboard:"dashboard",reports:"reports"},params:{},initialize:function(){},route:function(a,b,c){var d=this;c||(c=this[b]);var e=function(){c.apply(d,arguments)};return Backbone.Router.prototype.route.call(this,a,b,e)},livePreview:function(){function b(){if(!window.parent.settings_ready)return setTimeout(b,50);c.livePreviewView=new ThriveComments.views.LivePreview({collection:window.parent.ThriveComments.objects.Settings,el:a("#wpcontent")})}var c=this;b()},dashboard:function(){this.view&&(this.$el.empty(),this.unbind()),
ThriveComments.objects.Settings=new ThriveComments.collections.Settings,ThriveComments.objects.SettingsModel=new ThriveComments.models.Settings,this.view=new ThriveComments.views.Dashboard({collection:ThriveComments.objects.Settings,el:this.$el}),ThriveComments.objects.Settings.fetch().done(function(){window.settings_ready=1})},reports:function(){this.view=new ThriveComments.views.Reporting({el:this.$el})}});a(function(){ThriveComments.router=new b,Backbone.history.start({hashchange:!0}),Backbone.history.fragment||ThriveComments.router.navigate("#dashboard",{trigger:!0})})}(jQuery);var FallbackStorage={setItem:function(a,b){},getItem:function(a){},removeItem:function(a){}};TCMStorage.prototype.set=function(a,b){if(!a||void 0===b||null===b)return this;"object"===(void 0===b?"undefined":_typeof(b))&&(b=JSON.stringify(b));try{this.api.setItem(a,b)}catch(a){}return this},TCMStorage.prototype.get=function(a){if(a){var b=this.api.getItem(a);if(!b)return b;try{return JSON.parse(b)}catch(a){return b}}},TCMStorage.prototype.unset=function(a){if(!a)return this;try{this.api.removeItem(a)}catch(a){}return this},TCMStorage.prototype._listen=function(){var a=this,b=function(b){b||(b=window.event);var c=a.listeners[b.key];c&&c.length&&c.forEach(function(a){a(JSON.parse(b.newValue),JSON.parse(b.oldValue))})};window.addEventListener?window.addEventListener("storage",b,!1):window.attachEvent?window.attachEvent("onstorage",b):window.onstorage=b},TCMStorage.prototype.on=function(a,b){this.listeners[a]?this.listeners[a].push(b):this.listeners[a]=[b],!1===this.listening&&(this._listen(),this.listening=!0)},TCMStorage.prototype.off=function(a,b){var c=listeners[a];c.length>1?c.splice(c.indexOf(b),1):listeners[a]=[]},TCMStorage.instance=function(){return this._instance||(this._instance=new TCMStorage),this._instance},ThriveComments.LocalStorage=TCMStorage.instance();