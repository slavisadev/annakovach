/*! Thrive Architect - 2022-01-25
* http://www.thrivethemes.com/
* Copyright (c) 2022 Thrive Themes */

"use strict";!function(o){var t={isGutenbergActive:function(){return"undefined"!=typeof wp&&void 0!==wp.blocks},init:function(){var n=this;this.$gutenberg=o("#editor"),this.$architectNotificationContent=o("#thrive-gutenberg-switch").html(),this.$architectDisplay=o('<div id="tar-display">').append(this.$architectNotificationContent),this.$architectLauncher=this.$architectDisplay.find("#thrive_preview_button"),this.isPostBox=-1!==this.$architectNotificationContent.indexOf("postbox"),o(window).on("storage.tcb",function(t){var e,i=wp.data.select("core/editor").getCurrentPost();try{e=JSON.parse(t.originalEvent.newValue)}catch(t){}e&&e.ID&&"tve_post_options_change"===t.originalEvent.key&&e.ID===Number(i.id)&&window.location.reload()}),wp.data.subscribe(function(){var t=wp.data.select("core/editor");if(t){var e=t.isSavingPost(),i=t.isAutosavingPost();if(e&&!i){var o=JSON.stringify(t.getCurrentPost());window.localStorage.setItem("tve_post_options_change",o)}}setTimeout(function(){n.render()},1)})},render:function(){var t=this,e=!1;if(this.isPostBox){if(!o("#tar-display").length){var i=this.$gutenberg.find(".editor-post-title");i.length&&("DIV"===i[0].tagName?i.append(this.$architectDisplay):i.after(this.$architectDisplay)),this.$gutenberg.find(".editor-block-list__layout,.block-editor-block-list__layout").hide(),this.$gutenberg.find(".editor-post-title__block").css("margin-bottom","0"),this.$gutenberg.find(".editor-writing-flow__click-redirect,.block-editor-writing-flow__click-redirect").hide(),this.$gutenberg.find(".edit-post-header-toolbar").css("visibility","hidden"),e=!0}}else o("#thrive_preview_button").length||(this.$gutenberg.find(".edit-post-header-toolbar").append(this.$architectLauncher),this.$architectLauncher.on("click",function(){t.$gutenberg.find(".editor-block-list__layout").hide()}),this.$gutenberg.find(".edit-post-header-toolbar").css("visibility","visible"),e=!0);o(".editor-block-list__layout,.block-editor-block-list__layout").addClass("tcb-style-wrap"),e&&this.bindEvents()},bindEvents:function(){var e=this;o("#tcb2-show-wp-editor").on("click",function(){var t=e.$gutenberg.find(".tcb-enable-editor").closest(".postbox");o.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"disable_tcb"}}).done(function(t){}),t.next(".tcb-flags").find("input").prop("disabled",!1),t.remove(),e.$gutenberg.find(".editor-block-list__layout,.block-editor-block-list__layout").show(),e.isPostBox=!1,e.render(),e.fixBlocksPreview()}),this.$architectLauncher.on("click",function(){o.ajax({type:"post",url:ajaxurl,dataType:"json",data:{_nonce:TCB_Post_Edit_Data.admin_nonce,post_id:this.getAttribute("data-id"),action:"tcb_admin_ajax_controller",route:"change_post_status_gutenberg"}})})},fixBlocksPreview:function(){var t=document.querySelectorAll('[data-type*="thrive"] iframe');Array.prototype.forEach.call(t,function(t){var e=t.contentDocument;t.style.setProperty("height",""),t.parentNode.style.setProperty("height",""),Array.prototype.forEach.call(e.body.querySelectorAll(".tve-countdown"),function(t){t.style.setProperty("--tve-countdown-size","")});var i=function(t){if(!t)return 0;var e=t.offsetHeight,i=getComputedStyle(t);return e+=parseInt(i.marginTop)+parseInt(i.marginBottom)}(e.body);t.style.setProperty("height",i+"px"),t.parentNode.style.setProperty("height",i+"px")})}};o(function(){t.isGutenbergActive()&&t.init(),window.addEventListener("load",function(){o(".tcb-revert").on("click",function(){confirm("Are you sure you want to DELETE all of the content that was created in this landing page and revert to the theme page? \n If you click OK, any custom content you added to the landing page will be deleted.")&&(location.href=location.href+"&tve_revert_theme=1&nonce="+this.dataset.nonce,o("#editor").find(".edit-post-header-toolbar").css("visibility","visible"))})})})}(jQuery);